# Apache VirtualHost Configurations for All Apps
# Updated to include all xtuff.ai subdomains with HTTPS support

# Main xtuff.ai - Port 8500 (All Applications Runner)
<VirtualHost *:80>
    ServerName xtuff.ai
    ServerAlias www.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    # Redirect HTTP to HTTPS
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</VirtualHost>

# Social Xtuff - Port 8501
<VirtualHost *:80>
    ServerName social.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    # Redirect HTTP to HTTPS
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</VirtualHost>

# Codexes Factory - Port 8502
<VirtualHost *:80>
    ServerName codexes.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    ErrorLog ${APACHE_LOG_DIR}/codexes-error.log
    CustomLog ${APACHE_LOG_DIR}/codexes-access.log combined

    #Allow Let's Encrypt verification
    Alias /.well-known /var/www/html/.well-known
    <Directory /var/www/html/.well-known>
        Require all granted
    </Directory>

    RewriteEngine On
    # Don't proxy Let's Encrypt verification
    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*)           ws://127.0.0.1:8502/$1 [P,L]
    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/
    RewriteCond %{HTTP:Upgrade} !=websocket [NC]
    RewriteRule /(.*)           http://127.0.0.1:8502/$1 [P,L]

    ProxyPreserveHost On
    ProxyPass /.well-known !
    ProxyPass / http://127.0.0.1:8502/
    ProxyPassReverse / http://127.0.0.1:8502/
</VirtualHost>

# Trillions of People - Port 8504
<VirtualHost *:80>
    ServerName trillions.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    ErrorLog ${APACHE_LOG_DIR}/trillions-error.log
    CustomLog ${APACHE_LOG_DIR}/trillions-access.log combined

    # Allow Let's Encrypt verification
    Alias /.well-known /var/www/html/.well-known
    <Directory /var/www/html/.well-known>
        Require all granted
    </Directory>

    RewriteEngine On
    # Don't proxy Let's Encrypt verification
    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*)           ws://127.0.0.1:8504/$1 [P,L]
    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/
    RewriteCond %{HTTP:Upgrade} !=websocket [NC]
    RewriteRule /(.*)           http://127.0.0.1:8504/$1 [P,L]

    ProxyPreserveHost On
    ProxyPass /.well-known !
    ProxyPass / http://127.0.0.1:8504/
    ProxyPassReverse / http://127.0.0.1:8504/
</VirtualHost>

# Daily Engine - Port 8509
<VirtualHost *:80>
    ServerName daily.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    ErrorLog ${APACHE_LOG_DIR}/daily-error.log
    CustomLog ${APACHE_LOG_DIR}/daily-access.log combined

    # Allow Let's Encrypt verification
    Alias /.well-known /var/www/html/.well-known
    <Directory /var/www/html/.well-known>
        Require all granted
    </Directory>

    RewriteEngine On
    # Don't proxy Let's Encrypt verification
    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*)           ws://127.0.0.1:8509/$1 [P,L]
    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/
    RewriteCond %{HTTP:Upgrade} !=websocket [NC]
    RewriteRule /(.*)           http://127.0.0.1:8509/$1 [P,L]

    ProxyPreserveHost On
    ProxyPass /.well-known !
    ProxyPass / http://127.0.0.1:8509/
    ProxyPassReverse / http://127.0.0.1:8509/
</VirtualHost>

# AI Resume Builder - Port 8512
<VirtualHost *:80>
    ServerName resume.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    ErrorLog ${APACHE_LOG_DIR}/resume-error.log
    CustomLog ${APACHE_LOG_DIR}/resume-access.log combined

    # Allow Let's Encrypt verification
    Alias /.well-known /var/www/html/.well-known
    <Directory /var/www/html/.well-known>
        Require all granted
    </Directory>

    RewriteEngine On
    # Don't proxy Let's Encrypt verification
    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*)           ws://127.0.0.1:8512/$1 [P,L]
    RewriteCond %{REQUEST_URI} !^/.well-known/acme-challenge/
    RewriteCond %{HTTP:Upgrade} !=websocket [NC]
    RewriteRule /(.*)           http://127.0.0.1:8512/$1 [P,L]

    ProxyPreserveHost On
    ProxyPass /.well-known !
    ProxyPass / http://127.0.0.1:8512/
    ProxyPassReverse / http://127.0.0.1:8512/
</VirtualHost>

# Legacy domains kept for backwards compatibility

# Collectiverse - Port 8503
<VirtualHost *:80>
    ServerName collectiverse.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    ErrorLog ${APACHE_LOG_DIR}/collectiverse-error.log
    CustomLog ${APACHE_LOG_DIR}/collectiverse-access.log combined

    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:8503/
    ProxyPassReverse / http://127.0.0.1:8503/

    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*)           ws://127.0.0.1:8503/$1 [P,L]
    RewriteCond %{HTTP:Upgrade} !=websocket [NC]
    RewriteRule /(.*)           http://127.0.0.1:8503/$1 [P,L]
</VirtualHost>

# altDOGE - Port 8505
<VirtualHost *:80>
    ServerName altdoge.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    ErrorLog ${APACHE_LOG_DIR}/altdoge-error.log
    CustomLog ${APACHE_LOG_DIR}/altdoge-access.log combined

    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:8505/
    ProxyPassReverse / http://127.0.0.1:8505/

    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*)           ws://127.0.0.1:8505/$1 [P,L]
    RewriteCond %{HTTP:Upgrade} !=websocket [NC]
    RewriteRule /(.*)           http://127.0.0.1:8505/$1 [P,L]
</VirtualHost>

# Old Daily Engine domain (redirect to daily.xtuff.ai)
<VirtualHost *:80>
    ServerName dailyengine.xtuff.ai
    ServerAdmin wfzimmerman@gmail.com

    Redirect permanent / https://daily.xtuff.ai/
</VirtualHost>
